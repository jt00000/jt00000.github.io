---
layout: page
title: "4月まとめ"
date: 2021-04-99 00:00:00 -0000
---

### wanictf2021
- (4/30) pwnだけがんばって埋められたけどあと進まず。
    - pwnのgacha breakerは結局抽選結果を操作するところに、前に出た結果をコピーするという部分を愚直に利用すればよかったんだけどちゃんと見てなくて、memsetが構造体に対して短かったり絶妙なoffbyoneがあったりに釣られて、かなり時間がかかった。
    - tower of hanoiはどっか非ゼロにすれば良さそうだったから、rbp見ながらオフセット適当に伸ばして当てた。

### wpi
- (4/25) aarch64のret2csu問をやった。cpctfもやってたらしい。pwnだけチェックした。

### midnightsun
- (4/10) pwnタグのついたblind sqliをweb担当の人に投げる仕事と、本業のshapesが解けずに終了するだけ。
    - shapesはタイプごとに機能があるんだけど、機能的にtype confusionできないとダメみたいな感じ。必死に探したりしたけどなくて、createに謎の未初期化スタックポインタに書き込むとかいうバグの相手してた（exploitableでない）。あとから見ると、コマンドの１つは明らかに不審なダブルチェックをしており、ワンチャンあった可能性がある。

### angstrom
- (4/3) pwn簡単なの4問と、少ししんどめ2問解いた。
    - pawnはチェスの問題で、チェス盤の行を保持する構造体と、チェス盤の内容を文字列で持つ構造体の２つがあって、no-pieでuafになっているので、bssに構造体を持ってきて一生懸命ガチャる。駒を消すコマンドがあって、実際は消す代わりにインクリされていく値と入れ替えるので、これを使って書き換えたいところに駒を進めて、駒を消すことで書き換える。最後駒が足りるか足らんかのところで、queenが動かないことに気づき冷や汗をかくも、無駄に使っていたpawnを持ってきて生きるという熱めの展開を経る。exploitが３００行を超える長編大作になった。
    - carpal tunnel syndromeはビンゴカードの問題で、これもheapにビンゴカードのセルごとにポインタを持つ構造体になっている。ビンゴになった後の行か列のリセットがuafになっていて、任意の大きさで文字を入力させてくれるので、同じ大きさで確保してポインタを変える。これとは別にリセット機能があるので、特に不整合を考えてちまちまやる必要はなくて、セルの中身を指すポインタを1/16でgotに向けてリークして、マークのインデックス確認不足があるのでビンゴカードを伸ばしてマークを入れる。
    - (4/7) uqlが一番難しい問題で、vectorのeraseでイテレータの更新がされないようになっているところをどうするか。endに到達しない場合はキャッチしてくれるので動作が継続する。上手いことやるとendがbeginより小さくすることができて、その時にvectorに入っていたチャンクがリーク、編集できるんだけど、上手いことfreeチャンクを管理できなくて詰んだ。そもそも仕組みがよくわからないので調べる。
        - (4/8) セミコロンをセパレータと思って使っていて、getlineの第三引数は実はデリミタということに気づいた。コマンド間を分ける必要もない。コマンド連続して送ってんのにdisplayからのremoveが走らないから後ろがリークしないなあと思って３日間困ってたんだけど合点が行った。程度が低め。ソースの解析は間違っていなくて、最後尾の要素を削除するとイテレータが後ろに進んでしまうのを利用する。ここだけ上手くいけば割と簡単。

### foobarCTF
- (4/1) pwn６問解き切り。珍しく目新しいのは無くて、2時間半くらいで終わった。そういえばなんかlibc配ってるのにリモートで動いてるのが違うやつがあったな。極悪すぎて笑えない。

### その他
- (-4/18) 支援士勉強ウィークとし、ｶﾀｶﾀを封印。今度はさすがに受かった（1年ぶりn度目）
- (4/26) pwnable tw1問埋めた。久々すぎ。微妙に動かないライブラリもらうとめちゃくちゃ時間かかる。
- (4/27) もう一問。stdoutリークがうまくいかない。
- (4/28) cse466のbabyheap埋めた。malloc_usable_sizeの実装など眺めた。