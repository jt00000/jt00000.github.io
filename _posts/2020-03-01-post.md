---
layout: page
title: "3月まとめ"
date: 2020-02-22 00:00:00 -0000
categories: pwn 
---

### Aero2020
- (3/1)Pwn4問。久々にガッツリ解けたけど後1問残ったし、残ったやつ凡ミスすぎて悔しい。
    - plane_market: tcache poisoning. 終端null処理しない＋uaf＋任意サイズmallocがあるので、0x420をfreeしてリーク→free hookにsystemを乗せるだけ。
    - shell me if you can: シェルコード＋追加の命令コードで、いろいろ邪魔されるやつ。命令コードはRSLCの4つでそれぞれ条件があって一部をnopに差し替えたり、読み出し開始位置をずらしたりする。解析した結果、アルファヌメリックシェルコードが刺さることを確認したのでそのまま投げた。
    - ticket_storage: かなりの謎問だった。フラグが最初に読み込まれるが、チケットIDが不明な状態になる。7回チケットを登録するとheapのアドレス一覧がBSSに移されて、検索機能が使えるようになる。一覧の一番最初の8バイトは名前を変更するところと重複しているので、ヒープリークしてflagのオフセットを特定した後に、名前のアドレスにflagのアドレスを持つ偽チケット構造体を作って、重複しているところにそのアドレスを入れて、偽チケット構造体のチケットIDで検索するとフラグが読める。
    - 32bitでfcloseを何とかする問題。ファイルストリームのポインタが雑に扱われるのでかなり簡単にわかったが、fcloseからなんとかするのが久々すぎてだいぶ詰まったし、最後引数のところに制約が入ってしまって上手く行かなかったので、ヒープにpivotしてropしたらprintfでスタック奪われすぎて危うく成功しないところだった。別にそんなことしなくていいらしい。雑すぎた。これが解けたんだけどリモートで刺さらなくて諦めて、あとでもっかい繋いだら行けた。最初からちゃんと設定して欲しいという気持ちと、そういう設定に不備があってもフラグを通しちゃうやばい人間がいるという普通の感動の気持ちがある。
    - passkeeper: これが解けなくてずっと悩んでた。fp freeしてtcache poisoningするだけの問題で、id管理にoff-by-one的なのがあるのは分かってたけど、free上手く行かないなって何故か誤解したまま進めててどえらいことになってた。カス。

### 競プロ
- (3/1)abc157、Cまで。Dが問題の意味がわからない。グラフが繋がってないところを数えたらいいんじゃないの。何も分からん。
- (3/3)abc157のD復習。意味が分かってから問題文を読むと理解できる。Union Find Tree使った。これやりながら蟻本広げると少しだけ捗る。